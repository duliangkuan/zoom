# 线下会议室管理系统设计方案

## 一、系统概述

本系统是一个公司内部的线下会议室管理系统，主要用于管理8个会议室的预约、会议邀请发送和参会人员签到功能。

## 二、功能需求分析

### 2.1 会议室时间段预约功能
- **会议室数量**：8个线下会议室
- **预约时间范围**：24小时全天候可预约
- **时间粒度**：以30分钟为最小预约单位
- **预约信息**：
  - 会议主题
  - 参会人员（从团队成员列表中选择）
  - 会议时间段（开始时间-结束时间）
  - 会议室编号/名称
  - 预约人信息

### 2.2 发送会议邀请功能
- **邮箱管理**：
  - 前端可添加团队成员信息（姓名、QQ邮箱）
  - 团队成员信息永久保存（数据库存储）
  - 支持编辑、删除团队成员
- **邮件发送**：
  - 使用SMTP协议发送邮件
  - 预约会议后一键发送邀请邮件
  - 邮件内容包含：会议主题、时间、地点、参会人员等

### 2.3 签到功能
- **会议列表展示**：
  - 显示当前及未来的会议列表
  - 显示会议基本信息（主题、时间、地点）
- **签到操作**：
  - 点击对应会议进入签到页面
  - 参会人员可进行签到
  - 记录签到时间和状态

## 三、技术架构设计（Vercel优化版）

### 3.1 全栈技术栈
- **框架**：Next.js 14+ (App Router) + TypeScript
- **UI组件库**：Ant Design（提供丰富的表单、表格、日历组件）
- **状态管理**：React Hooks + Context API
- **HTTP请求**：原生fetch API
- **时间处理**：dayjs
- **数据库ORM**：Prisma（支持Vercel Postgres和外部数据库）
- **数据库**：
  - 推荐：Vercel Postgres（原生支持）或 Supabase/PlanetScale
  - 备选：外部PostgreSQL/MySQL服务
- **邮件服务**：nodemailer（Node.js Serverless Functions）
- **API设计**：Next.js API Routes (Serverless Functions)
- **部署平台**：Vercel（全栈部署）

### 3.3 数据库设计

#### 3.3.1 会议室表（meeting_rooms）
```
- id: 主键
- room_number: 会议室编号（1-8）
- room_name: 会议室名称
- capacity: 容纳人数
- facilities: 设备设施（JSON格式）
- status: 状态（可用/维护中）
```

#### 3.3.2 团队成员表（team_members）
```
- id: 主键
- name: 姓名
- email: QQ邮箱
- department: 部门（可选）
- position: 职位（可选）
- created_at: 创建时间
- updated_at: 更新时间
```

#### 3.3.3 会议预约表（meetings）
```
- id: 主键
- room_id: 会议室ID（外键）
- title: 会议主题
- start_time: 开始时间（datetime）
- end_time: 结束时间（datetime）
- organizer_id: 预约人ID（外键关联团队成员）
- description: 会议描述（可选）
- status: 状态（已预约/已取消/已完成）
- created_at: 创建时间
- updated_at: 更新时间
```

#### 3.3.4 会议参会人员关联表（meeting_participants）
```
- id: 主键
- meeting_id: 会议ID（外键）
- member_id: 参会人员ID（外键）
- status: 参会状态（已邀请/已确认/已拒绝）
- created_at: 创建时间
```

#### 3.3.5 签到记录表（check_ins）
```
- id: 主键
- meeting_id: 会议ID（外键）
- member_id: 参会人员ID（外键）
- check_in_time: 签到时间（datetime）
- status: 签到状态（正常/迟到/未签到）
- created_at: 创建时间
```

## 四、系统模块设计

### 4.1 Next.js项目结构
```
project/
├── app/                    # Next.js App Router
│   ├── api/                # API Routes (Serverless Functions)
│   │   ├── rooms/          # 会议室API
│   │   ├── meetings/       # 会议API
│   │   ├── team-members/   # 团队成员API
│   │   ├── check-ins/      # 签到API
│   │   └── email/          # 邮件API
│   ├── booking/            # 预约页面
│   ├── team-members/       # 团队成员管理页面
│   ├── check-in/           # 签到页面
│   ├── layout.tsx          # 根布局
│   └── page.tsx            # 首页
├── components/             # 公共组件
│   ├── Calendar/           # 日历组件
│   ├── TimeSlotPicker/     # 时间段选择器
│   └── MeetingCard/        # 会议卡片
├── lib/                    # 工具库
│   ├── prisma.ts           # Prisma客户端
│   ├── email.ts            # 邮件发送工具
│   └── utils.ts            # 工具函数
├── types/                  # TypeScript类型定义
├── prisma/                 # Prisma配置
│   ├── schema.prisma       # 数据库Schema
│   └── migrations/         # 数据库迁移
├── public/                 # 静态资源
├── .env.local              # 本地环境变量
├── vercel.json             # Vercel配置
└── package.json
```

### 4.2 后端API设计

#### 4.2.1 会议室相关API
- `GET /api/rooms` - 获取所有会议室列表
- `GET /api/rooms/:id` - 获取会议室详情
- `GET /api/rooms/:id/availability` - 获取会议室可用时间段

#### 4.2.2 预约相关API
- `GET /api/meetings` - 获取会议列表（支持筛选：日期、会议室、状态）
- `POST /api/meetings` - 创建会议预约
- `PUT /api/meetings/:id` - 更新会议信息
- `DELETE /api/meetings/:id` - 取消会议
- `GET /api/meetings/:id` - 获取会议详情

#### 4.2.3 团队成员相关API
- `GET /api/team-members` - 获取团队成员列表
- `POST /api/team-members` - 添加团队成员
- `PUT /api/team-members/:id` - 更新团队成员信息
- `DELETE /api/team-members/:id` - 删除团队成员

#### 4.2.4 邮件相关API
- `POST /api/meetings/:id/send-invitation` - 发送会议邀请邮件

#### 4.2.5 签到相关API
- `GET /api/meetings/:id/check-ins` - 获取会议签到记录
- `POST /api/check-ins` - 提交签到
- `GET /api/check-ins/meeting/:meeting_id` - 获取指定会议的签到列表

## 五、核心功能实现方案

### 5.1 时间段预约功能
1. **时间段选择器**：
   - 使用日历组件选择日期
   - 时间轴显示（00:00-23:30，每30分钟一个时间段）
   - 已预约时间段显示为不可选（灰色）
   - 支持跨时间段选择（如：09:00-10:30）

2. **冲突检测**：
   - 预约时检查时间段是否已被占用
   - 前端实时显示可用时间段
   - 后端API验证时间段冲突

3. **预约流程**：
   ```
   选择会议室 → 选择日期 → 选择时间段 → 填写会议信息 → 
   选择参会人员 → 提交预约 → 发送邀请（可选）
   ```

### 5.2 邮件发送功能
1. **SMTP配置**：
   - 后端配置SMTP服务器信息（QQ邮箱SMTP）
   - 使用环境变量存储敏感信息（邮箱账号、授权码）

2. **邮件模板**：
   - 设计HTML邮件模板
   - 包含会议基本信息、时间、地点、参会人员列表
   - 支持添加会议链接或二维码

3. **批量发送**：
   - 遍历参会人员列表
   - 异步发送邮件
   - 记录发送状态和失败原因

### 5.3 签到功能
1. **会议列表**：
   - 按时间排序显示会议
   - 显示会议状态（即将开始/进行中/已结束）
   - 支持筛选（今日会议、本周会议等）

2. **签到页面**：
   - 显示会议详细信息
   - 参会人员列表（显示签到状态）
   - 签到按钮（仅参会人员可见）
   - 签到时间记录

3. **签到逻辑**：
   - 验证用户是否为参会人员
   - 记录签到时间
   - 判断是否迟到（与会议开始时间对比）

## 六、UI/UX设计建议

### 6.1 预约页面
- 左侧：会议室列表（8个会议室卡片）
- 中间：日历和时间段选择器
- 右侧：预约信息表单
- 底部：参会人员选择（多选，支持搜索）

### 6.2 团队成员管理页面
- 表格展示团队成员列表
- 支持添加、编辑、删除操作
- 支持按姓名、邮箱搜索

### 6.3 签到页面
- 顶部：筛选器（今日/本周/全部）
- 会议卡片列表：显示会议主题、时间、地点、参会人数
- 点击卡片进入详情页进行签到

## 七、安全与性能考虑

### 7.1 安全
- API接口需要身份验证（JWT Token）
- 防止时间段冲突的并发问题（数据库锁）
- SMTP密码等敏感信息加密存储
- 输入验证和SQL注入防护

### 7.2 性能
- 时间段查询优化（索引：room_id, start_time, end_time）
- 邮件发送异步处理（消息队列）
- 前端数据缓存（已预约时间段）
- 分页加载会议列表

## 八、部署方案（Vercel优化）

### 8.1 开发环境
- 使用 `npm run dev` 启动Next.js开发服务器
- 本地数据库连接（通过环境变量配置）
- Prisma Studio用于数据库管理

### 8.2 生产环境（Vercel）
- **前端+后端**：Next.js全栈应用，自动部署到Vercel
- **数据库**：
  - 方案A：Vercel Postgres（推荐，原生集成）
  - 方案B：Supabase/PlanetScale（外部服务）
- **环境变量**：在Vercel Dashboard配置
- **Serverless Functions**：自动按需扩展
- **优势**：
  - 零配置部署
  - 自动HTTPS
  - 全球CDN加速
  - 自动CI/CD

## 九、开发计划

### 阶段一：基础框架搭建
1. 项目初始化（前后端）
2. 数据库设计和创建
3. 基础API接口开发

### 阶段二：核心功能开发
1. 会议室预约功能
2. 团队成员管理功能
3. 邮件发送功能

### 阶段三：签到功能开发
1. 会议列表展示
2. 签到功能实现

### 阶段四：优化与测试
1. UI优化
2. 性能优化
3. 功能测试

## 十、最终技术选型（Vercel部署）

### 确定方案：Next.js全栈
- **框架**：Next.js 14+ (App Router) + TypeScript
- **UI库**：Ant Design
- **数据库**：Vercel Postgres（或Supabase/PlanetScale）
- **ORM**：Prisma
- **邮件**：nodemailer
- **部署**：Vercel（一键部署）
- **优势**：
  - 全栈统一技术栈
  - Serverless Functions自动扩展
  - 优秀的开发体验
  - 零配置部署

---

## 待确认事项

1. **技术栈选择**：您更倾向于Node.js还是Python后端？
2. **数据库选择**：MySQL还是PostgreSQL？
3. **身份认证**：是否需要用户登录系统？还是简单的内部系统？
4. **权限管理**：是否需要不同角色（管理员、普通用户）？
5. **会议室信息**：8个会议室是否需要不同的名称和容量信息？
6. **邮件模板**：是否需要自定义邮件模板样式？
7. **签到方式**：是否需要二维码签到？还是简单的按钮签到？

请确认以上设计方案，如有需要调整的地方请告知，确认后我将开始生成代码。

